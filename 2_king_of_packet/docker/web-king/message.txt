#!/bin/bash
echo -e "\033[1;32mWelcome to King of the Packet 0x1337\033[0m"
echo -e "--------------------------------------------------------------------------------"
echo -e "We found out that a hacker tried to steal our car. We noticed her capturing our"
echo -e "traffic. Management wants an assessment. I think we are safe. We run the car "
echo -e "engine server on a secret \033[1;32mIP address\033[0m and \033[1;32mUDP port\033[0m. Even after that the hacker"
echo -e "would need to figure out the \033[1;32mpassword\033[0m. And even they do, they still wont know"
echo -e "how to control the car because we dont publish the \033[1;32mcommands\033[0m to drive the car"
echo -e "--------------------------------------------------------------------------------"
echo -e "The hacker got frustrated and quit but left her capture on the target."
echo -e "We need you to investigate and figure out if you can take over the car."
echo -e "--------------------------------------------------------------------------------"
echo -e "The hacker left a note that we think may help."
echo -e "\033[1;32mcapture.pcapng\033[0m holds all the secrets, I think." 
echo -e "--------------------------------------------------------------------------------"
echo -e "One of our techs reminded us that \033[1;32mtshark\033[0m might be useful in extracting info."
echo -e "You can use it to filter fields like the ip address, port, and data of a capture" 
echo -e "Fields that might be useful are \033[1;32mip.src, ip.sport, ip.dst, ip.dport, data.data\033[0m"
echo -e "The following tshark command will show the ip source, udp port, and data"
echo -e ""
echo -e "\033[1;32mtshark -r capture.pcapng -T fields -e ip.src -e udp.srcport -e data.data\033[0m"
echo -e ""
echo -e "One other note, \033[1;32mdata.data\033[0m is encoded in hexadecimal. You will need to decode it."
echo -e "For example, try using the command \033[1;32munhex 476f696e6720666f7277617264730a\033[0m"
echo -e "--------------------------------------------------------------------------------"
echo -e "After determining the ip address and port, connect using netcat. You"
echo -e "can connect using \033[1;32mnc -u \033[31mIP PORT\033[0m. But replace IP and PORT with the correct values"
